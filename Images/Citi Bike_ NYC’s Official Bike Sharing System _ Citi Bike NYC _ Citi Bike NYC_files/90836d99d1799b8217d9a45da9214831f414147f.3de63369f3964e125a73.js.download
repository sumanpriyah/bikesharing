(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[27],{"1LDT":function(t,e,n){"use strict";n.r(e),n.d(e,"ClientStats",(function(){return s})),n.d(e,"StatType",(function(){return o})),n.d(e,"createClientStats",(function(){return a})),n.d(e,"getClientStatsHandler",(function(){return c}));const r={url:"/api/client-log",prefix:"",disablePooling:!1,poolDurationMs:1e3,preferBeacon:!1,cache:!0};var i;!function(t){t.InvalidStat="Invalid client stat",t.MissingDuration="Missing duration for timing stat",t.MissingCount="Missing count for gauge stat",t.UnknownStat="Unknown stat type",t.StatsSent="Client stats sent",t.ParseError='Error parsing client stats request. Ensure bodyParser.text({ type: ["text/plain", "json"] }) middleware is being used.'}(i||(i={}));var o;!function(t){t.INCR="incr",t.TIMING="timing",t.GAUGE="gauge"}(o||(o={}));class s{constructor(t){var e,n;this.start=()=>{this.poolDisabled||this.intervalId||"undefined"===typeof window||(this.intervalId=setInterval(this.flush,this.poolDuration),document.addEventListener("visibilitychange",this.onVizChange),window.addEventListener("pagehide",this.onHide))},this.onVizChange=()=>{"hidden"===document.visibilityState&&this.onHide()},this.onHide=()=>{this.flush(),this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)},this.send=async t=>{var e,n;if(this.preferBeacon&&(null===(e=window)||void 0===e||null===(n=e.navigator)||void 0===n?void 0:n.sendBeacon))return Promise.resolve(!!window.navigator.sendBeacon(this.url,JSON.stringify(t)));try{return await this.client.post(this.url,{data:t}),!0}catch{return!1}},this.flush=async()=>{const t=this.pool.length;if(t){const e=this.pool.splice(0,t);await this.send(e)||(this.pool=e.concat(this.pool))}},this.format=t=>({...t,name:`${this.prefix}${t.name}`}),this.push=t=>{this.poolDisabled?this.sendStat(t):(this.pool.push(this.format(t)),this.start())},this.sendStat=t=>{this.send(this.format(t))},this.incr=(t,e,n)=>{this.push({type:o.INCR,name:t,tags:n,value:e})},this.timing=(t,e,n)=>{this.push({type:o.TIMING,name:t,duration:e,tags:n})},this.gauge=(t,e,n)=>{this.push({type:o.GAUGE,name:t,count:e,tags:n})};const i={...r,...t};if(this.pool=[],this.client=i.serviceClient,this.intervalId=null,this.url=null!==(e=i.url)&&void 0!==e?e:r.url,this.prefix=i.prefix?`${i.prefix}.`:r.prefix,this.preferBeacon=null!==(n=i.preferBeacon)&&void 0!==n?n:r.preferBeacon,!i.disablePooling&&!i.poolDurationMs)throw new Error('ClientStats: Invalid poolDurationMs provided. Set "disablePooling" if stat pooling is not desired.');this.poolDisabled=i.disablePooling,this.poolDuration=i.poolDurationMs}static create(t){var e,n;const i=null!==(e=t.cache)&&void 0!==e?e:r.cache,o=`${null!==(n=t.url)&&void 0!==n?n:r.url}${t.prefix?`#${t.prefix}`:""}`;if(i&&o in s.cache)return s.cache[o];const a=new s(t);return i&&(s.cache[o]=a),a}}function a(t){return s.create(t)}function c({stats:t,logger:e,debug:n}){const r=(t,n)=>{e.warn({body:t,error:n},i.InvalidStat)},s=e=>{const{type:n,name:s,tags:a}=e;if(n&&s)switch(n){case o.INCR:t.increment(s,e.value,a);break;case o.TIMING:"undefined"===typeof e.duration?r(e,i.MissingDuration):t.timing(s,e.duration,a);break;case o.GAUGE:"undefined"===typeof e.count?r(e,i.MissingCount):t.gauge(s,e.count,a);break;default:r(e,i.UnknownStat)}else r(e,i.InvalidStat)};return function({body:t},r){try{const r="string"===typeof t?JSON.parse(t):t;Array.isArray(r)?r.forEach((t=>s(t))):s(r),n&&e.debug({body:t,statsData:r},i.StatsSent)}catch{e.error({body:t},i.ParseError)}return r.status(204).end()}}s.cache={}},"4jF4":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("mxbo"),i=n("woEc");const o=new r.ServiceClient({service:"lyftcomfe",serviceUrl:i.d.LYFT_COM_URL,requestTimeout:1e4}),s=new r.ServiceClient({service:"lyftcomfe",serviceUrl:i.d.BRAND_URL,requestTimeout:200});e.b=o},"7oyz":function(t,e,n){"use strict";n.d(e,"b",(function(){return l}));var r=n("rePB"),i=n("mxbo"),o=n("woEc");function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){Object(r.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const c={service:"www2",serviceUrl:o.d.LYFT_COM_URL,requestTimeout:1e3},u=new i.ServiceClient(c),l=(t=1e3)=>new i.ServiceClient(a(a({},c),{},{requestTimeout:t}));e.a=u},Ravl:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.S=function(t){var e,n,i=t.App,o=t.stats;return n=e=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(n,t);var e=function(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=f(t);if(e){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}(n);function n(){return s(this,n),e.apply(this,arguments)}return function(t,e,n){e&&a(t.prototype,e);n&&a(t,n)}(n,[{key:"render",value:function(){return o?(0,r.createElement)(d.Provider,{value:o},c(f(n.prototype),"render",this).call(this)):c(f(n.prototype),"render",this).call(this)}}]),n}(i),e.displayName="StatsAppPlugin",n},e.u=e.d=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!==typeof t)return{default:t};var e=i();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var a=r?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=t[s]}n.default=t,e&&e.set(t,n);return n}(n("q1tI"));function i(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return i=function(){return t},t}function o(t){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return(c="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p;e.d={name:"@lyft/service-plugin-stats",pathname:"/api/client-stats",debug:!1},"undefined"!==typeof window&&window.StatsContext&&(p=window.StatsContext),p||((p=r.default.createContext({sendStat:function(){return!0},incr:function(){return!0},timing:function(){return!0},gauge:function(){return!0}})).displayName="StatsPluginContext","undefined"!==typeof window&&(window.StatsContext=p));e.u=function(){return{stats:(0,r.useContext)(p)}};var d=p},kkKK:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("zxvb"),i=n("4jF4"),o=n("mOvS"),s=n.n(o);const{SERVICE_NAME:a}=s()().publicRuntimeConfig,c=Object(r.createClientStats)({prefix:a,url:"/api/lyftcomfe/client-stats",serviceClient:i.b})},zxvb:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"ClientStats",{enumerable:!0,get:function(){return r.ClientStats}}),Object.defineProperty(e,"createClientStats",{enumerable:!0,get:function(){return r.createClientStats}}),Object.defineProperty(e,"useStats",{enumerable:!0,get:function(){return o.u}}),e.getStats=e.default=void 0;var r=n("1LDT"),i=n("XGKz"),o=n("Ravl");function s(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n("q1tI");e.getStats=function(){throw new Error("getStats can only be used on the server. Use useStats or createClientStats instead.")};var l=function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=o.d.name,this.serviceName=void 0,this.pathname=o.d.pathname,this.serviceClient=void 0,this.stats=void 0,this.options=void 0,this.getClientStats=function(t){if(!n.serviceClient)throw new TypeError("serviceClient not specified. Provide the serviceClient using plugin options.");return(0,r.createClientStats)(c(c({},n.options),{},{prefix:t,url:n.pathname,serviceClient:n.serviceClient}))},this.apply=function(t){t.hooks.app.tap(n.name,(function(t){return(0,o.S)({App:t,stats:n.stats})}))};var a=e.serviceName,u=e.serviceClient,l=e.pathname,f=(e.logger,e.debug,s(e,["serviceName","serviceClient","pathname","logger","debug"]));this.serviceName=a||i.env.SERVICE_NAME,this.pathname=l||o.d.pathname,this.serviceClient=u,this.options=f,this.stats=this.getClientStats(this.serviceName)};e.default=l}}]);